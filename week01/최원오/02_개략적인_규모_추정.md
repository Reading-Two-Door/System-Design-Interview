# 개략적인 규모 추정

- 개략적인 규모 추정은 보편적으로 통용되는 성능 수치상에서 사고 실험을 행하여 추정치를 계산하는 행위로서, 어떤 설계가 요구사항에 부합할 것인지 보기 위한 것
- 개략적 규모 추정을 효과적으로 해 내려면 규모 확장성을 표현하는 데 필요한 기본기에 능숙해야한다. (2의 제곱수, 응답지연 값, 가용성에 관계된 수치)

## 2의 제곱수

- 제대로 된 계산 결과를 얻으려면 데이터 볼륨의 단위를 2의 제곱수로 표현하면 어떻게 되는지를 알아야 한다.

## 모든 프로그래머가 알아야 하는 응답지연 값

- 메모리는 빠르지만 디스크는 아직도 느리다.
- 디스크 탐색은 가능한 피하라
- 단순한 압축 알고리즘은 빠르다.
- 데이터를 인터넷을 전송하기 전에 가능하면 압축하라.
- 데이터 센터는 보통 여러 지역에 분산되어 있고, 센터들 간에 데이터를 주고 받는 데는 시간이 걸린다.

## 가용성에 관계된 수치들

- 고가용성은 시스템이 오랜 시간 지속적으로 중단 없이 운영될 수 있는 능력을 지칭하는 용어다.
- 고가용성을 표현하는 값은 퍼센트로 표현하며 대부분의 서비스는 99%에서 100% 사이의 값을 갖는다.
- SLA(Service Level Agreement)는 서비스 사업자와 고객 사이에 맺어진 합의를 의미하며, 이 합의는 사업자가 제공하는 서비스의 가용시간이 공식적으로 기술되어 있다.

## 예제: 트위터 QPS와 저장소 요구량 추정

### 가정

- 월간 능동 사용자는 3억 명이다.
- 50%의 사용자가 트위터를 매일 사용한다.
- 평균적으로 각 사용자는 매일 2건의 트윗을 올린다.
- 미디어를 포함하는 트윗은 10% 정도다.
- 데이터는 5년간 보관한다.

### 추정

- QPS(Query Per Second) 추정치 : 초당 처리할 수 있는 쿼리 수

  - 일간 능동 사용자 = 3억 x 50% = 1.5억
  - QPS = 1.5억 x 2 트윗 / 24시간 / 3600초 = 약 3500개
  - 최대 QPS = 2 x QPS = 약 7000개

- 미디어 저장을 위한 저장소 요구량
  - 평균 트윗 크기
    - tweet_id에 64바이트
    - 텍스트에 140바이트
    - 미디어에 1MB
  - 미디어 저장소 요구량 : 1.5억 x 2 x 10 % x 1MB = 30TB/ 일
  - 5년간 미디어를 보관하기 위한 저장소 요구량: 30TB x 365 x 5 = 약 55PB

## 팁

개략적인 규모 추정과 관련된 면접에서 가장 중요한 것은 문제를 풀어나가는 절차다. 즉, 올바른 절차를 밟느냐가 결과를 내는 것보다 중요하다.

근사치를 활용한 계산 : 99987 / 9.1 보다는 100,000 / 10로 수치를 간소화
가정들을 적어 놓자
단위를 붙이자 ex ) 5가 5KB인지 5MB인지 적는 습관화
계략적 규모 추정 문제는 QPS, 최대 QPS, 저장소 요구량, 캐시 요구량, 서버 수 등을 추정하는 것이다.
